(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[249],{3208:function(t,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sandboxes/prevent_double_submit",function(){return r(580)}])},580:function(t,n,r){"use strict";r.r(n),r.d(n,{default:function(){return g}});var e,o,i,a,u=r(5893),c=r(7294);function s(t){var n=String(t);if("[object Object]"===n)try{n=JSON.stringify(t)}catch(t){}return n}var l=new(function(){function t(){this.some=!1,this.none=!0}return t.prototype[Symbol.iterator]=function(){return{next:function(){return{done:!0,value:void 0}}}},t.prototype.unwrapOr=function(t){return t},t.prototype.expect=function(t){throw Error(""+t)},t.prototype.unwrap=function(){throw Error("Tried to unwrap None")},t.prototype.map=function(t){return this},t.prototype.andThen=function(t){return this},t.prototype.toResult=function(t){return f(t)},t.prototype.toString=function(){return"None"},t}());Object.freeze(l);var p=function(){function t(n){if(!(this instanceof t))return new t(n);this.some=!0,this.none=!1,this.val=n}return t.prototype[Symbol.iterator]=function(){var t=Object(this.val);return Symbol.iterator in t?t[Symbol.iterator]():{next:function(){return{done:!0,value:void 0}}}},t.prototype.unwrapOr=function(t){return this.val},t.prototype.expect=function(t){return this.val},t.prototype.unwrap=function(){return this.val},t.prototype.map=function(t){return p(t(this.val))},t.prototype.andThen=function(t){return t(this.val)},t.prototype.toResult=function(t){return h(this.val)},t.prototype.safeUnwrap=function(){return this.val},t.prototype.toString=function(){return"Some("+s(this.val)+")"},t.EMPTY=new t(void 0),t}();(e=i||(i={})).all=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],e=0;e<t.length;e++){var o=t[e];if(!o.some)return o;r.push(o.val)}return p(r)},e.any=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=0;r<t.length;r++){var e=t[r];return e.some,e}return l},e.isOption=function(t){return t instanceof p||t===l};var f=function(){function t(n){if(!(this instanceof t))return new t(n);this.ok=!1,this.err=!0,this.val=n;var r=Error().stack.split("\n").slice(2);r&&r.length>0&&r[0].includes("ErrImpl")&&r.shift(),this._stack=r.join("\n")}return t.prototype[Symbol.iterator]=function(){return{next:function(){return{done:!0,value:void 0}}}},t.prototype.else=function(t){return t},t.prototype.unwrapOr=function(t){return t},t.prototype.expect=function(t){throw Error(t+" - Error: "+s(this.val)+"\n"+this._stack)},t.prototype.unwrap=function(){throw Error("Tried to unwrap Error: "+s(this.val)+"\n"+this._stack)},t.prototype.map=function(t){return this},t.prototype.andThen=function(t){return this},t.prototype.mapErr=function(t){return new f(t(this.val))},t.prototype.toOption=function(){return l},t.prototype.toString=function(){return"Err("+s(this.val)+")"},Object.defineProperty(t.prototype,"stack",{get:function(){return this+"\n"+this._stack},enumerable:!1,configurable:!0}),t.EMPTY=new t(void 0),t}(),h=function(){function t(n){if(!(this instanceof t))return new t(n);this.ok=!0,this.err=!1,this.val=n}return t.prototype[Symbol.iterator]=function(){var t=Object(this.val);return Symbol.iterator in t?t[Symbol.iterator]():{next:function(){return{done:!0,value:void 0}}}},t.prototype.else=function(t){return this.val},t.prototype.unwrapOr=function(t){return this.val},t.prototype.expect=function(t){return this.val},t.prototype.unwrap=function(){return this.val},t.prototype.map=function(t){return new h(t(this.val))},t.prototype.andThen=function(t){return t(this.val)},t.prototype.mapErr=function(t){return this},t.prototype.toOption=function(){return p(this.val)},t.prototype.safeUnwrap=function(){return this.val},t.prototype.toString=function(){return"Ok("+s(this.val)+")"},t.EMPTY=new t(void 0),t}();(o=a||(a={})).all=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],e=0;e<t.length;e++){var o=t[e];if(!o.ok)return o;r.push(o.val)}return new h(r)},o.any=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var r=[],e=0;e<t.length;e++){var o=t[e];if(o.ok)return o;r.push(o.val)}return new f(r)},o.wrap=function(t){try{return new h(t())}catch(t){return new f(t)}},o.wrapAsync=function(t){try{return t().then(function(t){return new h(t)}).catch(function(t){return new f(t)})}catch(t){return Promise.resolve(new f(t))}},o.isResult=function(t){return t instanceof f||t instanceof h};let y=async function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),e=1;e<n;e++)r[e-1]=arguments[e];try{return h(await t(...r))}catch(t){return f(t)}},v=t=>{let{content:n,onClickHandler:r,onClickErrorHandler:e}=t,[o,i]=(0,c.useState)(!1);return(0,u.jsx)("button",{disabled:o,onClick:async t=>{if(!o){i(!0);try{await r(t)}catch(t){await e(t)}finally{i(!1)}}},children:n})},d=t=>{let{content:n,onClick:r}=t,[e,o]=(0,c.useState)(!1);return(0,u.jsx)("button",{disabled:e,onClick:async t=>{e||(o(!0),await r(t),o(!1))},children:n})},m=t=>new Promise(n=>setTimeout(n,t)),w=t=>{let[n,r]=(0,c.useState)(!1);return[async function(){for(var e=arguments.length,o=Array(e),i=0;i<e;i++)o[i]=arguments[i];if(n){console.log("don't start to fetch");return}r(!0),await t(...o),r(!1)},n]},b=(t,n)=>{let[r,e]=(0,c.useState)(!1);return(0,c.useEffect)(()=>{t.current.disabled=r},[r]),async function(){for(var t=arguments.length,o=Array(t),i=0;i<t;i++)o[i]=arguments[i];r||(e(!0),await n(...o),e(!1))}};var g=()=>{let t=(0,c.useRef)(null),[n,r]=(0,c.useState)(!1),[e,o]=w(async t=>{let n=await y(fetch,"https://example.com",{mode:"no-cors"});await m(1e3),n.err&&console.error(n.val.message),console.log(n.val),console.log(t)}),i=(0,c.useRef)(null),a=b(i,async t=>{let n=await y(fetch,"https://example.com",{mode:"no-cors"});n.err&&console.error(n.val.message),console.log(n.val),console.log(t)});return(0,u.jsxs)("div",{children:[(0,u.jsx)("button",{ref:t,onClick:async n=>{t.current.disabled=!0;try{let t=await fetch("https://example.com",{mode:"no-cors"});console.log(t)}catch(t){console.log(t.message)}finally{t.current.disabled=!1}},children:"disabled imperatively"}),(0,u.jsx)("button",{disabled:n,onClick:async t=>{if(!n){r(!0);try{let t=await fetch("https://example.com",{mode:"no-cors"});console.log(t)}catch(t){console.log(t.message)}finally{r(!1)}}},children:"disabled via naive useState"}),(0,u.jsx)(v,{content:(0,u.jsx)(u.Fragment,{children:"complex prevent double submit button"}),onClickHandler:async t=>{console.log(await fetch("https://example.com",{mode:"no-cors"}))},onClickErrorHandler:async t=>{console.log(t.message)}}),(0,u.jsx)(d,{content:(0,u.jsx)(u.Fragment,{children:"prevent double submit button"}),onClick:async()=>{let t=await y(fetch,"https://example.com",{mode:"no-cors"});t.err&&console.error(t.val.message),console.log(t.val)}}),(0,u.jsx)("button",{disabled:o,onClick:t=>e(t),children:"custom hook with useState"}),(0,u.jsx)("button",{onClick:t=>e(t),children:"custom hook with useState(always clickable)"}),(0,u.jsx)("button",{ref:i,onClick:t=>a(t),children:"custom hook with useRef"})]})}}},function(t){t.O(0,[888,774,179],function(){return t(t.s=3208)}),_N_E=t.O()}]);