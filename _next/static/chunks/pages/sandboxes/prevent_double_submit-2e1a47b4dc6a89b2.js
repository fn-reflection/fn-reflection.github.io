(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[249],{3208:function(t,n,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/sandboxes/prevent_double_submit",function(){return e(580)}])},580:function(t,n,e){"use strict";e.r(n),e.d(n,{default:function(){return k}});var r,o,i,a,c=e(5893),u=e(7294);function s(t){var n=String(t);if("[object Object]"===n)try{n=JSON.stringify(t)}catch(t){}return n}var l=new(function(){function t(){this.some=!1,this.none=!0}return t.prototype[Symbol.iterator]=function(){return{next:function(){return{done:!0,value:void 0}}}},t.prototype.unwrapOr=function(t){return t},t.prototype.expect=function(t){throw Error(""+t)},t.prototype.unwrap=function(){throw Error("Tried to unwrap None")},t.prototype.map=function(t){return this},t.prototype.andThen=function(t){return this},t.prototype.toResult=function(t){return f(t)},t.prototype.toString=function(){return"None"},t}());Object.freeze(l);var p=function(){function t(n){if(!(this instanceof t))return new t(n);this.some=!0,this.none=!1,this.val=n}return t.prototype[Symbol.iterator]=function(){var t=Object(this.val);return Symbol.iterator in t?t[Symbol.iterator]():{next:function(){return{done:!0,value:void 0}}}},t.prototype.unwrapOr=function(t){return this.val},t.prototype.expect=function(t){return this.val},t.prototype.unwrap=function(){return this.val},t.prototype.map=function(t){return p(t(this.val))},t.prototype.andThen=function(t){return t(this.val)},t.prototype.toResult=function(t){return h(this.val)},t.prototype.safeUnwrap=function(){return this.val},t.prototype.toString=function(){return"Some("+s(this.val)+")"},t.EMPTY=new t(void 0),t}();(r=i||(i={})).all=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var e=[],r=0;r<t.length;r++){var o=t[r];if(!o.some)return o;e.push(o.val)}return p(e)},r.any=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var e=0;e<t.length;e++){var r=t[e];return r.some,r}return l},r.isOption=function(t){return t instanceof p||t===l};var f=function(){function t(n){if(!(this instanceof t))return new t(n);this.ok=!1,this.err=!0,this.val=n;var e=Error().stack.split("\n").slice(2);e&&e.length>0&&e[0].includes("ErrImpl")&&e.shift(),this._stack=e.join("\n")}return t.prototype[Symbol.iterator]=function(){return{next:function(){return{done:!0,value:void 0}}}},t.prototype.else=function(t){return t},t.prototype.unwrapOr=function(t){return t},t.prototype.expect=function(t){throw Error(t+" - Error: "+s(this.val)+"\n"+this._stack)},t.prototype.unwrap=function(){throw Error("Tried to unwrap Error: "+s(this.val)+"\n"+this._stack)},t.prototype.map=function(t){return this},t.prototype.andThen=function(t){return this},t.prototype.mapErr=function(t){return new f(t(this.val))},t.prototype.toOption=function(){return l},t.prototype.toString=function(){return"Err("+s(this.val)+")"},Object.defineProperty(t.prototype,"stack",{get:function(){return this+"\n"+this._stack},enumerable:!1,configurable:!0}),t.EMPTY=new t(void 0),t}(),h=function(){function t(n){if(!(this instanceof t))return new t(n);this.ok=!0,this.err=!1,this.val=n}return t.prototype[Symbol.iterator]=function(){var t=Object(this.val);return Symbol.iterator in t?t[Symbol.iterator]():{next:function(){return{done:!0,value:void 0}}}},t.prototype.else=function(t){return this.val},t.prototype.unwrapOr=function(t){return this.val},t.prototype.expect=function(t){return this.val},t.prototype.unwrap=function(){return this.val},t.prototype.map=function(t){return new h(t(this.val))},t.prototype.andThen=function(t){return t(this.val)},t.prototype.mapErr=function(t){return this},t.prototype.toOption=function(){return p(this.val)},t.prototype.safeUnwrap=function(){return this.val},t.prototype.toString=function(){return"Ok("+s(this.val)+")"},t.EMPTY=new t(void 0),t}();(o=a||(a={})).all=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var e=[],r=0;r<t.length;r++){var o=t[r];if(!o.ok)return o;e.push(o.val)}return new h(e)},o.any=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];for(var e=[],r=0;r<t.length;r++){var o=t[r];if(o.ok)return o;e.push(o.val)}return new f(e)},o.wrap=function(t){try{return new h(t())}catch(t){return new f(t)}},o.wrapAsync=function(t){try{return t().then(function(t){return new h(t)}).catch(function(t){return new f(t)})}catch(t){return Promise.resolve(new f(t))}},o.isResult=function(t){return t instanceof f||t instanceof h};let y=async function(t){for(var n=arguments.length,e=Array(n>1?n-1:0),r=1;r<n;r++)e[r-1]=arguments[r];try{return h(await t(...e))}catch(t){return f(t)}},v=t=>{let{content:n,onClickHandler:e,onClickErrorHandler:r}=t,[o,i]=(0,u.useState)(!1);return(0,c.jsx)("button",{disabled:o,onClick:async t=>{if(!o){i(!0);try{await e(t)}catch(t){await r(t)}finally{i(!1)}}},children:n})},m=t=>{let{content:n,onClick:e}=t,[r,o]=(0,u.useState)(!1);return(0,c.jsx)("button",{disabled:r,onClick:async t=>{r||(o(!0),await e(t),o(!1))},children:n})},d=t=>new Promise(n=>setTimeout(n,t)),w=t=>{let[n,e]=(0,u.useState)(!1);return[async function(){for(var r=arguments.length,o=Array(r),i=0;i<r;i++)o[i]=arguments[i];if(n){console.log("don't start to fetch");return}e(!0),await t(...o),e(!1)},n]},b=(t,n)=>{let[e,r]=(0,u.useState)(!1);return(0,u.useEffect)(()=>{t.current.disabled=e},[e]),async function(){for(var t=arguments.length,o=Array(t),i=0;i<t;i++)o[i]=arguments[i];e||(r(!0),await n(...o),r(!1))}},g=t=>{let{f:n,limit:e=1}=t,[r,o]=(0,u.useState)(0);return[async function(){let t;for(var i=arguments.length,a=Array(i),c=0;c<i;c++)a[c]=arguments[c];if(!(e<=r)){o(t=>t+1);try{t=await n(...a)}finally{o(t=>t-1)}return t}},r]},x=(t=>{let{f:n,limit:e=1}=t,r=0;return async function(){let t;for(var o=arguments.length,i=Array(o),a=0;a<o;a++)i[a]=arguments[a];if(!(e<=r)){r+=1;try{t=await n(...i)}finally{r-=1}return t}}})({f:async t=>{let n=await fetch("https://example.com",{mode:"no-cors"});await d(1e3),console.log(n),await fetch("https://example.co",{mode:"no-cors"})}});var k=()=>{let t=(0,u.useRef)(null),[n,e]=(0,u.useState)(!1),[r,o]=w(async t=>{let n=await y(fetch,"https://example.com",{mode:"no-cors"});await d(1e3),n.err&&console.error(n.val.message),console.log(n.val),console.log(t)}),i=(0,u.useRef)(null),a=b(i,async t=>{let n=await y(fetch,"https://example.com",{mode:"no-cors"});n.err&&console.error(n.val.message),console.log(n.val),console.log(t)}),[s,l]=g({f:async t=>{let n=await fetch("https://example.com",{mode:"no-cors"});await d(1e3),console.log(n),await fetch("https://example.co",{mode:"no-cors"})}}),[p,f]=g({f:async t=>{let n=await fetch("https://example.com",{mode:"no-cors"});await d(1e3),console.log(n),await fetch("https://example.co",{mode:"no-cors"})},limit:2});return(0,c.jsxs)("div",{children:[(0,c.jsx)("button",{ref:t,onClick:async n=>{t.current.disabled=!0;try{let t=await fetch("https://example.com",{mode:"no-cors"});console.log(t)}catch(t){console.log(t.message)}finally{t.current.disabled=!1}},children:"disabled imperatively"}),(0,c.jsx)("button",{disabled:n,onClick:async t=>{if(!n){e(!0);try{let t=await fetch("https://example.com",{mode:"no-cors"});console.log(t)}catch(t){console.log(t.message)}finally{e(!1)}}},children:"disabled via naive useState"}),(0,c.jsx)(v,{content:(0,c.jsx)(c.Fragment,{children:"complex prevent double submit button"}),onClickHandler:async t=>{console.log(await fetch("https://example.com",{mode:"no-cors"}))},onClickErrorHandler:async t=>{console.log(t.message)}}),(0,c.jsx)(m,{content:(0,c.jsx)(c.Fragment,{children:"prevent double submit button"}),onClick:async()=>{let t=await y(fetch,"https://example.com",{mode:"no-cors"});t.err&&console.error(t.val.message),console.log(t.val)}}),(0,c.jsx)("button",{disabled:o,onClick:async t=>await r(t),children:"custom hook with useState"}),(0,c.jsx)("button",{onClick:async t=>await r(t),children:"custom hook with useState(always clickable)"}),(0,c.jsx)("button",{ref:i,onClick:async t=>await a(t),children:"custom hook with useRef"}),(0,c.jsx)("button",{onClick:async t=>await x(t),children:"vanilla js rate limit impl"}),(0,c.jsxs)("button",{onClick:async t=>await s(t),children:["rate limited event. limit: 1, count: ",l]}),(0,c.jsxs)("button",{onClick:async t=>await p(t),children:["rate limited event. limit: 2, count: ",f]})]})}}},function(t){t.O(0,[888,774,179],function(){return t(t.s=3208)}),_N_E=t.O()}]);