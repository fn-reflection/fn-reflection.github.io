<!DOCTYPE html><html lang="ja"><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><title>fn-reflection</title><meta name="next-head-count" content="3"/><link rel="preload" href="/_next/static/css/c39843b2ba4d243f9268.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c39843b2ba4d243f9268.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a54b4f32bdc1ef890ddd.js"></script><script src="/_next/static/chunks/webpack-61095c13c5984b221292.js" defer=""></script><script src="/_next/static/chunks/framework-92300432a1172ef1338b.js" defer=""></script><script src="/_next/static/chunks/main-a76b5552fbb06f190312.js" defer=""></script><script src="/_next/static/chunks/pages/_app-2ad02387a8c1ff738da6.js" defer=""></script><script src="/_next/static/chunks/pages/index-3680c4d3fb9a8319d64c.js" defer=""></script><script src="/_next/static/WnhYXWgEelis93H5yIzrV/_buildManifest.js" defer=""></script><script src="/_next/static/WnhYXWgEelis93H5yIzrV/_ssgManifest.js" defer=""></script></head><body><div id="__next"><section><div><a href="/posts/yarn">yarn</a><p>yarnを扱う上での便利コマンド</p></div></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"allPosts":[{"date":"2021-08-07","excerpt":"yarnを扱う上での便利コマンド","slug":"yarn","title":"yarn","content":"\n## yarnとは\n\nyarnはnode.jsなどを主としたソフトウェアを作るときにパッケージ(例えば他の人が作成した外部プログラム)を利用する上で便利なツールである。このようなツールはパッケージマネージャーとも呼ばれていて、非常に類似したものとしてはnpmがあるし、他の言語ではpip(python)、bundle(ruby)、maven(java)などが、OSではbrew(mac)やapt,dnf,yum,pacman(linux)などのツールがパッケージマネージャーとして利用されている。\n\nnode.jsはjavascriptの実行環境の一つであり、サーバーアプリケーションに使う他、webブラウザで動作するjavascriptを構築するためのツールがあるため、webフロントエンド開発にも使用されることが多い。\n\n所感：npmもyarnも使い方はほとんど変わらないので、迷っている場合はどちらでも良い。\n\n## yarnの基本\n\npackage.jsonというファイルをもとに利用するパッケージの名称を指定したりバージョンを(範囲)指定する。yarnを使ってパッケージを取得すると、yarn.lockというファイルが作られそこにパッケージのバージョンの正確な値などが記録される。\n\nパッケージを取得するとnode_modulesというディレクトリに保存され、パッケージ取得をやり直したい場合はnode_modulesディレクトリを消せば元の状態に戻る。\n\n## package.jsonの例\n\n※下の例では\u003ccode\u003e//\u003c/code\u003e以降に解説を記述するがpackage.jsonは普通のjsonファイルでありこのような記法は許容されないので、実際に利用するときは解説を除去すること\n\n他の人の作ったパッケージを利用するだけならdependencies系が特に重要。パッケージを公開する場合はバージョンやライセンスなども重要になる。\n\n```jsonc\n{\n  \"name\": \"my-new-project\", // このプロジェクトの名前\n  \"version\": \"1.0.0\", // このプロジェクトのバージョン\n  \"description\": \"説明用\", // プロジェクトの説明\n  \"main\": \"index.js\", // エントリーポイント\n  \"repository\": { // このプロジェクトが管理されているリポジトリ(例えばgithub)\n    \"url\": \"https://example.com/your-username/my-new-project\",\n    \"type\": \"git\"\n  },\n  \"author\": \"Your Name \u003cyou@example.com\u003e\", // 名前とemail\n  \"license\": \"MIT\", // このプロジェクトに適用するライセンス\n  \"scripts\": {\n    \"build\": \"babel src -d lib\", // yarn buildを実行するとbabel src -d libコマンドが実行される\n    \"test\": \"jest\"　// yarn testを実行するとjestコマンドが実行される\n  }\n  \"dependencies\": { // 使用するパッケージリスト\n    \"vue\": \"^2.6.12\"\n  },\n  \"devDependencies\": { // 開発時にのみ使用するパッケージリスト(具体的には環境変数NODE_ENV=productionにセットされた場合などは無視される)\n    \"vue-test-utils\": \"^1.0.0-beta.11\"\n  },\n  \"peerDependencies\": { // このプロジェクトを利用するプロジェクトに使用させるパッケージリスト(例えばeslintやreactなどのプラグインを作成するときなどに使うらしい)\n    \"eslint\": \"^2.3.19\"\n  },\n  \"optionalDependencies\": { // 必須ではないパッケージリスト、取得できなくてもエラーにならない。\n    \"watchman\": \"^2.3.19\"\n  },\n  \"bundledDependencies\": { // このプロジェクトをモジュールとして公開するときにモジュールとして一緒に保持するパッケージリスト\n    \"vue\"\n  },\n  \n}\n\n```\n\n## パッケージハンドリング\n\n```sh\nyarn init # yarnプロジェクトのベースになるpackage.jsonを対話形式で作成する\nyarn # package.jsonの情報に基づきパッケージをnode_modulesディレクトリに取得する。\nyarn install # yarnと同じ\nyarn install --check-files # パッケージが確かに取得されていることを確認する。\nyarn install --force # node_modulesに強制ダウンロード(これするよりは普通にnode_module消してyarnした方が簡単かも)\nyarn install --production # dependenciesのパッケージのみ取得する。(devDependenciesのとかは取得しない。)\nyarn install --prod # yarn install --productionと同じ\nyarn add package@version #パッケージを緩くバージョン指定してdependenciesに追加(1.2.4なら1.2.4以上2.0.0未満の最新バージョン)\nyarn add package@version --exact # パッケージを厳格にバージョン指定してdependenciesに追加\nyarn add package # = yarn add package@latest 最新バージョンを追加\nyarn add package --dev #　devDependenciesに追加\nyarn add package -D #　yarn add package --devと同じ\nyarn add package --peer # peerDependenciesに追加\nyarn add package --optional # optionalDependenciesに追加\nyarn global add package # プロジェクトではなくユーザー環境にパッケージを取得する\nyarn global dir # ユーザー環境にパッケージを取得する場合、その保存パスを表示する\nyarn upgrade package@version # パッケージを指定したバージョンに更新する\nyarn upgrade package # パッケージを最新バージョンに更新する\nyarn remove package # パッケージをdependenciesから削除する\nyarn why package # パッケージが取得されている理由を検索する\nyarn config set cache-folder \u003cpath\u003e # パッケージのキャッシュディレクトリを変更する、ebsとかを登録すると捗る？\n```\n\n## スクリプトの実行とか\n\n```sh\nyarn run # 実行可能なスクリプトコマンドを列挙する\nyarn run env # スクリプト実行時の環境変数を列挙する\n```\n\n## バージョン指定の記法\n\n```sh\n'~3.1.4' # 3.1.4以上 3.2.0未満\n'~3.1' # 3.1.0以上 3.2.0未満\n'~3' # 3.0.0以上 4.0.0未満\n'2.x' # メジャーバージョンが2である任意のバージョン\n'3.1.x' # 3.1から始まる任意のバージョン\n'=4.6.6' # バージョン 4.6.6 のみ\n'=3.1.4-beta.2' # ベータ版も指定できる\n'\u003e0.4.2' # 0.4.2 を超える任意のバージョン\n'\u003e=2.7.1'\t# 2.7.1 以上の任意のバージョン\n'\u003c2.0.0' # 2.0.0 未満の任意のバージョン\n'\u003c=3.1.4' #\t3.1.4 以下の任意のバージョン\n\"\u003e=2.0.0 \u003c3.1.4\" #  2.0.0 以上 3.14未満の任意のバージョン\n'2.0.0 - 3.1.4' #  2.0.0 以上 3.14以下の任意のバージョン\n'*' # 任意のバージョン\n```\n\n## yarn vs npm\n\nyarnの公式ドキュメントより抜粋\n\n| npm (v5)                                | Yarn                            |\n| :-------------------------------------- | :------------------------------ |\n| `npm install`                           | `yarn install`                  |\n| ない                                    | `yarn install --flat`           |\n| ない                                    | `yarn install --har`            |\n| `npm install --no-package-lock`         | `yarn install --no-lockfile`    |\n| ない                                    | `yarn install --pure-lockfile`  |\n| `npm install [package]`                 | `yarn add [package]`            |\n| `npm install [package] --save-dev`      | `yarn add [package] --dev`      |\n| ない                                    | `yarn add [package] --peer`     |\n| `npm install [package] --save-optional` | `yarn add [package] --optional` |\n| `npm install [package] --save-exact`    | `yarn add [package] --exact`    |\n| ない                                    | `yarn add [package] --tilde`    |\n| `npm install [package] --global`        | `yarn global add [package]`     |\n| `npm update --global`                   | `yarn global upgrade`           |\n| `npm rebuild`                           | `yarn install --force`          |\n| `npm uninstall [package]`               | `yarn remove [package]`         |\n| `npm cache clean`                       | `yarn cache clean [package]`    |\n| `rm -rf node_modules \u0026\u0026 npm install`    | `yarn upgrade`                  |"}]},"__N_SSG":true},"page":"/","query":{},"buildId":"WnhYXWgEelis93H5yIzrV","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>